@model Product

@{
    ViewData["Title"] = Model.Name;
}

<div class="product-details">
    <div class="container">
        <div class="breadcrumb">
            <a href="/">Home</a> / <a href="/Category/Products/@Model.CategoryId">@Model.Category.Name</a> / @Model.Name
        </div>
        
        <div class="product-layout">
            <div class="product-gallery-section">
                <div class="main-image-container">
                    <img src="@Model.MainImage" alt="@Model.Name" id="mainProductImage" onerror="this.src='https://via.placeholder.com/600x600?text=@Model.Name'" />
                </div>
                
                @if (Model.ProductImages.Any())
                {
                    <div class="thumbnail-gallery">
                        <div class="thumbnail-item active" onclick="changeMainImage('@Model.ProductImages')">
                            <img src="@Model.ProductImages" alt="@Model.Name" onerror="this.src='https://via.placeholder.com/100?text=Main'" />
                        </div>
                        @foreach (var image in Model.ProductImages)
                        {
                            <div class="thumbnail-item" onclick="changeMainImage('@image.ImageUrl')">
                                <img src="@image.ImageUrl" alt="@Model.Name" onerror="this.src='https://via.placeholder.com/100?text=N/A'" />
                            </div>
                        }
                    </div>
                }
            </div>
            
            <div class="product-main">
                <h1 class="product-name">@Model.Name</h1>
                <p class="product-price">$@Model.Price.ToString("N2")</p>
                
                <div class="product-description">
                    <h3>Description</h3>
                    <p>@Model.Description</p>
                </div>
                
                <div class="product-meta">
                    <div class="meta-item">
                        <strong>Category:</strong> @Model.Category.Name
                    </div>
                    <div class="meta-item">
                        <strong>Stock:</strong> 
                        @if (Model.Stock > 0)
                        {
                            <span class="in-stock">✓ @Model.Stock units available</span>
                        }
                        else
                        {
                            <span class="out-stock">✗ Out of Stock</span>
                        }
                    </div>
                </div>
                
                @if (Model.Stock > 0)
                {
                    <div class="order-section">
                        <h3>Place Your Order</h3>
                        <form method="post" action="/Product/PlaceOrder" class="order-form">
                            @Html.AntiForgeryToken()
                            <input type="hidden" name="ProductId" value="@Model.Id" />
                            
                            <div class="form-group">
                                <label>Full Name *</label>
                                <input type="text" name="CustomerName" required class="form-control" placeholder="John Doe" />
                            </div>
                            
                            <div class="form-group">
                                <label>Email Address *</label>
                                <input type="email" name="CustomerEmail" required class="form-control" placeholder="john@example.com" />
                            </div>
                            
                            <div class="form-group">
                                <label>Phone Number *</label>
                                <input type="tel" name="CustomerPhone" required class="form-control" placeholder="+1 234 567 8900" />
                            </div>
                            
                            <div class="form-group">
                                <label>Shipping Address *</label>
                                <textarea name="ShippingAddress" required class="form-control" rows="3" placeholder="123 Main St, City, State, ZIP"></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label>Quantity *</label>
                                <input type="number" name="Quantity" min="1" max="@Model.Stock" value="1" required class="form-control" />
                            </div>
                            
                            <button type="submit" class="btn-order">Place Order Now</button>
                        </form>
                    </div>
                }
                else
                {
                    <div class="out-of-stock-message">
                        <p>This product is currently out of stock. Please check back later.</p>
                        <a href="/Category/Products/@Model.CategoryId" class="btn-primary">Browse Similar Products</a>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        function changeMainImage(imageUrl) {
            document.getElementById('mainProductImage').src = imageUrl;
            
            // Update active thumbnail
            document.querySelectorAll('.thumbnail-item').forEach(item => {
                item.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
        }
    </script>
}
